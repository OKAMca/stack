{
  "project": "npm-to-pnpm-migration",
  "goal": "Migrate the Nx monorepo from npm to pnpm package manager",
  "config": {
    "agent": "claude",
    "context": "Nx monorepo with multiple publishable packages under libs/. Uses GitHub Actions for CI.",
    "verification": "pnpm install && pnpm nx run-many -t build lint --projects=tag:publishable"
  },
  "statuses": [
    "pending",
    "in_progress",
    "completed",
    "blocked"
  ],
  "tasks": [
    {
      "id": "1",
      "description": "Create pnpm-workspace.yaml configuration file",
      "status": "completed",
      "steps": [
        "Create pnpm-workspace.yaml at project root",
        "Define packages glob patterns for apps/* and libs/*"
      ]
    },
    {
      "id": "2",
      "description": "Remove package-lock.json and migrate to pnpm-lock.yaml",
      "status": "completed",
      "steps": [
        "Delete package-lock.json",
        "Run pnpm import to convert lock file (or pnpm install if import fails)",
        "Verify pnpm-lock.yaml is created"
      ]
    },
    {
      "id": "3",
      "description": "Update .npmrc for pnpm compatibility",
      "status": "completed",
      "steps": [
        "Check existing .npmrc settings",
        "Add pnpm-specific settings if needed (e.g., shamefully-hoist, strict-peer-dependencies)"
      ],
      "notes": "Created .npmrc with shamefully-hoist=true, auto-install-peers=true, and strict-peer-dependencies=false for Nx monorepo compatibility"
    },
    {
      "id": "4",
      "description": "Update .github/workflows/ci.yml to use pnpm",
      "status": "completed",
      "steps": [
        "Add pnpm/action-setup@v4 step with version 10 before actions/setup-node in each job (lint, test, build)",
        "Change cache: 'npm' to cache: 'pnpm' in actions/setup-node",
        "Replace 'npm ci' with 'pnpm install --frozen-lockfile'"
      ],
      "notes": "Updated all three jobs (lint, test, build) to use pnpm/action-setup@v4 with version 10, changed cache to pnpm, and replaced npm ci with pnpm install --frozen-lockfile"
    },
    {
      "id": "5",
      "description": "Update .github/workflows/publish.yml to use pnpm",
      "status": "completed",
      "steps": [
        "Add pnpm/action-setup@v4 step with version 10 before actions/setup-node",
        "Replace 'npm ci' with 'pnpm install --frozen-lockfile'",
        "Update 'npm whoami' debug command to 'pnpm whoami'"
      ],
      "notes": "Added pnpm/action-setup@v4 with version 10, added cache: 'pnpm' to setup-node, replaced npm ci with pnpm install --frozen-lockfile, replaced all npx nx with pnpm nx, updated npm whoami to pnpm whoami"
    },
    {
      "id": "6",
      "description": "Update package.json scripts that reference npm",
      "status": "pending",
      "steps": [
        "Search for npm references in package.json scripts",
        "Replace npm commands with pnpm equivalents"
      ]
    },
    {
      "id": "7",
      "description": "Update documentation to reference pnpm",
      "status": "pending",
      "steps": [
        "Update README.md with pnpm commands",
        "Update any contributing guides"
      ]
    },
    {
      "id": "8",
      "description": "Add .gitignore entries for pnpm",
      "status": "pending",
      "steps": [
        "Ensure node_modules is ignored",
        "Add .pnpm-store if needed"
      ]
    },
    {
      "id": "9",
      "description": "Add packageManager field to package.json for corepack",
      "status": "completed",
      "steps": [
        "Add \"packageManager\": \"pnpm@10.10.0\" to root package.json",
        "This enables corepack to automatically use the correct pnpm version"
      ],
      "notes": "Added packageManager field with pnpm@10.10.0 to root package.json. This enables corepack to automatically use the correct pnpm version and ensures consistent package manager across all environments."
    },
    {
      "id": "10",
      "description": "Configure dependabot.yml for pnpm dependency updates",
      "status": "pending",
      "steps": [
        "Update .github/dependabot.yml package-ecosystem to 'npm' (works for pnpm)",
        "Optionally adjust schedule interval and add ignore patterns"
      ]
    }
  ]
}
